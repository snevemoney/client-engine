# Production QA Report — evenslouis.ca

**Date:** 2026-02-23  
**Tested by:** Automated QA agent  
**Branch:** `cursor/production-app-validation-055b`  
**Production URL:** https://evenslouis.ca

---

## 1. Test Coverage Summary

### Local Automated Tests (Vitest + Playwright)

| Suite | Tests | Result | Notes |
|-------|-------|--------|-------|
| Vitest unit (`proof-engine/generate`) | 6 | **6 PASS** | All proof-line generation rules pass |
| Playwright: smoke (`/api/health`) | 1 | **PASS** | Health endpoint OK, DB up, pipeline tables present |
| Playwright: API auth (401 checks) | 15 | **15 PASS** | All protected endpoints return 401 without session |
| Playwright: Proof API auth | 4 | **4 PASS** | Proof + checklist endpoints gated correctly |
| Playwright: Pages (all dashboard) | 2 | **Skipped** | Requires valid credentials (E2E_EMAIL/PASSWORD not set) |
| Playwright: Full flow (login→lead) | 1 | **Skipped** | Requires valid credentials |
| Playwright: Lead Copilot | 3 | **Skipped** | Requires valid credentials |
| Playwright: Learning ingest | 1 | **Skipped** | Requires valid credentials |

**Total automated:** 26 PASS, 0 FAIL, 7 skipped (credential-gated)

### Manual Production Tests (Playwright against https://evenslouis.ca)

| Test | Result | Notes |
|------|--------|-------|
| Homepage loads | **PASS** | 578ms, 41KB, 0 console errors, 0 network errors |
| Homepage sections (services, contact, footer) | **PASS** | All sections visible, 3 nav links, 5 footer links |
| Homepage contact form visible | **PASS** | 5 inputs, submit disabled until email filled |
| Work page loads | **PASS** | 1350ms, 5 project cards |
| Login page loads | **PASS** | 597ms, email/password/button visible |
| Login bad credentials → error msg | **PASS** | Shows "Invalid credentials" |
| Login empty submit → stays on page | **PASS** | HTML5 validation prevents submit |
| All protected routes → login redirect | **PASS** | 14/14 routes redirect correctly |
| Privacy, Terms, Data Deletion pages | **PASS** | All 200, substantial content |
| 404 page | **PASS** | Returns 404 status |
| Work detail pages (5 projects) | **PASS** | All load with correct titles |
| Navigation links (home→work→contact) | **PASS** | All functional |
| API health endpoint | **PASS** | 200, all checks green |
| API auth enforcement (7 endpoints) | **PASS** | All return 401 |
| Site form API validation | **PASS** | Returns 400 on missing email |
| Site form API with data | **PASS** | Creates lead, returns leadId |
| HTTP→HTTPS redirect | **PASS** | 308 redirect |
| SSL certificate | **PASS** | Valid |

**Total manual production:** 18 PASS, 0 FAIL

---

## 2. Pass/Fail Table — Every Page

| Page | Route | Load | Content | Interactive | Auth | Verdict |
|------|-------|------|---------|-------------|------|---------|
| Homepage | `/` | 578ms, PASS | PASS | PASS | N/A (public) | **PASS** |
| Work (listing) | `/work` | 1350ms, PASS | PASS (5 projects) | PASS | N/A (public) | **PASS** |
| Work: Autoflow | `/work/autoflow` | 611ms | PASS | PASS | N/A | **PASS** |
| Work: AutoFlow Finance | `/work/autoflow-finance` | 605ms | PASS | PASS | N/A | **PASS** |
| Work: ProofCheck QC | `/work/proof-qc-assist` | 114ms | PASS | PASS | N/A | **PASS** |
| Work: Clearfield | `/work/clearfield` | 293ms | PASS | PASS | N/A | **PASS** |
| Work: QuickMarket | `/work/quickmarket` | 362ms | PASS | PASS | N/A | **PASS** |
| Login | `/login` | 597ms | PASS | PASS | N/A | **PASS** |
| Privacy | `/privacy` | 558ms | PASS (15.7K chars) | N/A | N/A | **PASS** |
| Terms | `/terms` | 92ms | PASS (17K chars) | N/A | N/A | **PASS** |
| Data Deletion | `/data-deletion` | 90ms | PASS (13.2K chars) | N/A | N/A | **PASS** |
| Command Centre | `/dashboard/command` | Redirect, 180ms | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Ops Health | `/dashboard` | Redirect, 648ms | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Sales Leak | (part of command) | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS | **PARTIAL** |
| Results Ledger | (part of metrics) | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS | **PARTIAL** |
| Leads | `/dashboard/leads` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Proposals | `/dashboard/proposals` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Build Ops | (part of deploys) | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS | **PARTIAL** |
| Metrics | `/dashboard/metrics` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Website/Work | `/work` | 1350ms | PASS | PASS | N/A | **PASS** |
| Chatbot | `/dashboard/chat` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Learning | `/dashboard/learning` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Settings | `/dashboard/settings` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Proof | `/dashboard/proof` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Checklist | `/dashboard/checklist` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Deploys | `/dashboard/deploys` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Conversion | `/dashboard/conversion` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |
| Knowledge | `/dashboard/knowledge` | **UNTESTED** | **UNTESTED** | **UNTESTED** | PASS (redirects) | **PARTIAL** |

**Note:** All dashboard pages marked "UNTESTED" are gated by authentication. Auth redirect works correctly for all 14 protected routes. Full dashboard content/interaction testing requires `E2E_EMAIL` and `E2E_PASSWORD` environment variables to be set for automated runs, or manual MCP browser login (not available in this environment). Code review was performed for all dashboard pages instead.

---

## 3. End-to-End Workflow Result (Research → Propose)

**Tested via:** Code trace + API probing (no authenticated session available for live run)

| Step | Mechanism | UI Visibility | Error Handling | Verdict |
|------|-----------|---------------|----------------|---------|
| **Research/Ingest** | RSS/Upwork adapters, email worker, manual creation, site form | Lead appears in list | Silent fire-and-forget trigger | **CONCERN** |
| **Enrich** | Auto-triggered by orchestrator | Artifact appears; no progress indicator | Error classified, logged, notified | **CONCERN** |
| **Score** | Auto-triggered after enrich | Score field populated | Error classified | **CONCERN** |
| **Position** | Auto-triggered after score | POSITIONING_BRIEF artifact | Error classified | **CONCERN** |
| **Propose** | Auto-triggered after position; requires positioning artifact | Proposal artifact created | Gate check (throws if missing) | **CONCERN** |

### Workflow Issues Found

1. **No pipeline progress indicator.** When a lead is created and the pipeline fires, there is zero visual feedback that steps are running. The user sees... nothing until artifacts appear (or don't).

2. **Individual step buttons bypass the orchestrator.** The "Enrich with AI", "Score Lead", "Generate Proposal" buttons on the lead detail page call `/api/enrich/[id]`, `/api/score/[id]`, `/api/propose/[id]` directly — these create their own PipelineRun but don't use the orchestrator's idempotency checks or advisory locks. This can cause duplicate artifacts and race conditions.

3. **Pipeline trigger is fire-and-forget.** `runPipelineIfEligible(lead.id, "reason")` is called without `await` on lead creation. If it fails, no error surfaces to the user.

4. **No retry UI.** The `/api/pipeline/retry/[leadId]` endpoint exists, but there's no button in the UI to trigger a retry. Failed pipelines are invisible unless you check the metrics page.

5. **RUN_REPORT artifacts not displayed.** The orchestrator creates RUN_REPORT artifacts on every run (success or failure), but these are not shown in the lead detail page.

6. **Processing state is invisible.** Axiom violation: "Processing state is visible (loading, status, progress, errors)" — the pipeline runs asynchronously with no real-time status shown to the operator.

---

## 4. Bugs Found (Ranked by Severity)

### SEV-1: Critical

| # | Title | Page/Route | Repro | Expected | Actual |
|---|-------|------------|-------|----------|--------|
| 1 | **No rate limiting on public site lead form** | `/api/site/leads` | Send 5+ rapid POST requests with different emails | Rate limit or CAPTCHA after threshold | All succeed (200). Easily spammable. Creates DB entries + sends notification emails each time. |
| 2 | **No input length validation on site lead form** | `/api/site/leads` | POST with 300+ char email | Reject or truncate | Accepted and stored. Could cause DB issues or email rendering problems with absurdly long values. |
| 3 | **Capture API missing try/catch around `req.json()` and DB ops** | `/api/capture` | Send invalid JSON body | 400 with error message | Uncaught exception, likely 500 |
| 4 | **Leads API POST missing try/catch around `req.json()` and DB ops** | `/api/leads` (POST) | Send invalid JSON body (authenticated) | 400 with error message | Uncaught exception, likely 500 |
| 5 | **Work detail page missing try/catch around DB query** | `/work/[slug]` | DB connection failure during page load | Error page or fallback | Unhandled crash (500) |

### SEV-2: High

| # | Title | Page/Route | Repro | Expected | Actual |
|---|-------|------------|-------|----------|--------|
| 6 | **Pipeline progress invisible to operator** | `/dashboard/leads/[id]` | Create a lead → pipeline runs automatically | Visual progress indicator (e.g., "Enriching...", "Scoring...") | Nothing visible. Artifacts appear silently after unknown delay, or not at all if failure occurs. |
| 7 | **Individual step buttons bypass orchestrator locks/idempotency** | `/dashboard/leads/[id]` | Click "Enrich with AI" while auto-pipeline is running | Queued or blocked | Race condition; possible duplicate artifacts |
| 8 | **No retry button in UI for failed pipeline runs** | `/dashboard/leads/[id]` | Pipeline fails (e.g., OpenAI rate limit) | Retry button visible with error context | No indication of failure. No retry option. Operator must check metrics page to discover. |
| 9 | **All security headers missing** | All pages | Check response headers | HSTS, X-Frame-Options, X-Content-Type-Options, CSP, Referrer-Policy | None present. Site can be iframed, no HSTS, no CSP. |
| 10 | **No OG/Twitter meta tags** | Homepage | Share URL on social media | Preview card with title, description, image | Generic text-only preview. No og:image, og:title, twitter:card, etc. |

### SEV-3: Medium

| # | Title | Page/Route | Repro | Expected | Actual |
|---|-------|------------|-------|----------|--------|
| 11 | **Login `callbackUrl` not validated** | `/login` | Visit `/login?callbackUrl=https://evil.com` → login | Redirect only to same-origin URLs | Redirects to arbitrary external URL (open redirect vulnerability) |
| 12 | **Command Centre page — no error boundary** | `/dashboard/command` | One of 21 parallel data fetches fails | Graceful degradation, show what loaded | Entire page crashes (SSR error) |
| 13 | **Error messages use `alert()` on multiple dashboard pages** | Leads new, Lead detail, Proof, Checklist | Trigger any API error | Inline error message with context | Browser `alert()` popup — feels broken, no context |
| 14 | **Leads list has no error state** | `/dashboard/leads` | API fetch fails (e.g., network error) | Error message with retry | Empty state shown ("No leads found.") — misleading |
| 15 | **Contact form error state is generic** | Homepage `/` (#contact) | Form submission fails (network error) | Specific error message | "Something went wrong. Try again or email directly." — no detail |
| 16 | **Incomplete HTML entity escaping in site leads email** | `/api/site/leads` | Submit name with `"` or `&` characters | Proper escaping | Only `<` is escaped. Partial XSS protection in email body. |

### SEV-4: Low

| # | Title | Page/Route | Repro | Expected | Actual |
|---|-------|------------|-------|----------|--------|
| 17 | **404 page uses default Next.js styling** | `/nonexistent` | Visit any invalid URL | Styled 404 matching site design (dark theme) | White background, default Next.js "404 This page could not be found" — jarring contrast |
| 18 | **Homepage shows only 3 of 5 projects** | `/` | Load homepage | All projects or clear "View all" context | Shows 3 projects in "Selected projects". Work page has 5. Not a bug per se, but the count discrepancy might confuse. |
| 19 | **Facebook Pixel loaded with no cookie consent** | `/` | Check page source | Cookie consent banner before tracking | FB pixel fires on page load with no consent mechanism |
| 20 | **No pagination on leads list** | `/dashboard/leads` | Have 100+ leads | Pagination or virtual scroll | All leads loaded at once (performance risk) |

---

## 5. UX Confusion Points

| # | Issue | Where | Impact |
|---|-------|-------|--------|
| 1 | **Pipeline runs silently.** After creating a lead, operator sees nothing happen for 10-60 seconds while enrich/score/position/propose runs. No loading bar, no step indicator, no status text. First-time users will think the app is broken. | Lead detail | High — "did it work?" uncertainty |
| 2 | **"No leads found" when fetch fails.** If the API is down or network fails, the leads page shows "No leads found" — same as empty state. Operator can't distinguish "I have no leads" from "something broke." | Leads list | Medium — misleading |
| 3 | **`alert()` for errors.** Multiple pages use browser `alert()` for error messages. This looks like 2005. Breaks the visual flow and provides no context for recovery. | Lead creation, Lead detail, Proof, Checklist | Medium — feels unprofessional |
| 4 | **Chat messages not persisted.** Operator Chat loses all history on page refresh. If you navigate away and come back, all context is gone. | Chat | Medium — wastes operator time |
| 5 | **No "last updated" timestamps.** Dashboard cards and metrics don't show when data was last refreshed. Operator can't tell if they're seeing stale data. | Command Centre, Metrics | Medium — trust issue |
| 6 | **Step buttons always visible on lead detail.** "Enrich with AI", "Score Lead", "Generate Proposal" buttons are shown even when the step has already been completed. No visual indication of what's done vs. what's next. | Lead detail | Medium — confusing |
| 7 | **New Lead form errors via `alert()`.** If creating a lead fails, the only feedback is a browser alert. No inline validation, no field highlighting. | New Lead | Low-Medium |
| 8 | **Login loading state too fast to see.** The "Signing in..." text on the button changes so quickly it's barely visible. Doesn't feel like the system is working. | Login | Low |

---

## 6. Performance Observations

| Area | Observation | Severity |
|------|-------------|----------|
| Homepage | 578ms — good. Cached (x-nextjs-cache: HIT). | OK |
| Work page | 1350ms — slightly slow for a listing page. | Minor |
| Work detail pages | 114-611ms — variable. ProofCheck QC is fast (114ms, likely cached), others slower. | OK |
| Login page | 597ms — acceptable. | OK |
| Legal pages | 90-558ms — Privacy was slow first load (558ms), then fast. | OK |
| Protected route redirects | 162-180ms — fast. | Good |
| Health API | 225ms — good. | OK |
| Command Centre | 21 parallel data fetches on SSR — potential bottleneck. Not measurable without auth. | **Concern** — likely the slowest page |
| Login page cache header | `s-maxage=31536000` (1 year cache). Login is prerendered but client-side. This is OK for the shell but worth noting. | OK |

---

## 7. Recommended Fixes (Quick Wins First)

### Quick Wins (< 1 hour each)

1. **Add rate limiting to `/api/site/leads`** — Use a simple in-memory counter or Redis-based limiter. Prevents spam abuse. (SEV-1)

2. **Add try/catch to `/api/capture` and `/api/leads` POST handlers** — Wrap `req.json()` and DB operations. Return 400/500 with proper error messages. (SEV-1)

3. **Add try/catch to `/work/[slug]` DB query** — Prevent crash on DB errors. (SEV-1)

4. **Add input length validation to `/api/site/leads`** — Max 255 chars for email, name, company, website. Max 2000 for message. (SEV-1)

5. **Add security headers via `next.config.ts`** — HSTS, X-Frame-Options, X-Content-Type-Options, Referrer-Policy. (SEV-2)

6. **Validate `callbackUrl` on login page** — Only allow same-origin redirects. `new URL(callbackUrl).origin === window.location.origin`. (SEV-3)

7. **Add OG meta tags** — og:title, og:description, og:image, twitter:card to root layout or per page. (SEV-2)

### Medium Effort (1-4 hours each)

8. **Add pipeline progress indicator to lead detail page** — Poll `/api/pipeline/status/[leadId]` or use SSE. Show "Enriching... (step 1/4)" with a progress bar. (SEV-2)

9. **Add retry button to lead detail page** — Show when pipeline status is "error". Call `/api/pipeline/retry/[leadId]`. (SEV-2)

10. **Replace `alert()` with inline error messages** — On lead creation, lead detail actions, proof generation, checklist generation. Use a toast or inline error component. (SEV-3)

11. **Add error boundary to Command Centre** — Wrap in React error boundary. Show partial data on failure. (SEV-3)

12. **Fix leads list error state** — Distinguish "No leads found" from "Failed to load leads. Retry?" (SEV-3)

13. **Escape all HTML entities in email body** — Use a proper HTML escaper, not just `<` replacement. (SEV-3)

### Larger Effort (4+ hours)

14. **Route individual step buttons through orchestrator** — Make "Enrich with AI" etc. call `/api/pipeline/run` with a `startAt` parameter instead of separate endpoints. Prevents race conditions. (SEV-2)

15. **Display RUN_REPORT artifacts in lead detail** — Show pipeline run history, success/failure, step-by-step results. (SEV-2)

16. **Add chat persistence** — Store messages in DB or sessionStorage at minimum. (UX)

17. **Custom 404 page** — Match site dark theme. (SEV-4)

18. **Add cookie consent** — Required for GDPR compliance if serving EU users (Facebook Pixel fires without consent). (SEV-4)

---

## 8. "Ready for Client Use?" Verdict

### **VERDICT: CONDITIONALLY READY — with blockers**

The public-facing site (homepage, work pages, contact form, legal pages) is **production-ready** and works well. Clean design, fast loads, forms work, auth gates are solid, 404 handling works.

### Blockers Before Full Client Use

| # | Blocker | Why |
|---|---------|-----|
| 1 | **No rate limiting on contact form** | A bot can spam thousands of leads into the DB and trigger notification emails. This will happen. |
| 2 | **Missing try/catch on 3 API routes** | Invalid JSON or DB errors will crash with 500. Looks unprofessional and leaks stack traces. |
| 3 | **Pipeline progress invisible** | First-time operator will create a lead and see nothing happen. They'll think the app is broken. This is the #1 adoption risk for the dashboard. |
| 4 | **No retry mechanism visible** | When the pipeline fails (it will — OpenAI rate limits, network blips), the operator has no way to recover without developer intervention. |
| 5 | **Missing security headers** | Site can be iframed (clickjacking), no HSTS. Basic security hygiene. |

### Non-Blockers (But Fix Soon)

- Open redirect on login page
- `alert()` error handling on dashboard pages
- No OG tags (hurts social sharing)
- Facebook Pixel without consent (GDPR risk)
- Chat not persisted

### What's Working Well

- Auth flow is solid — all protected routes redirect correctly, all API endpoints enforce 401
- Health endpoint is comprehensive (DB, pipeline tables, auth secret, NextAuth URL)
- Pipeline orchestrator design is solid (advisory locks, idempotency, error classification, notifications)
- Public site loads fast, looks professional, contact form works cleanly
- Proof engine unit tests are thorough
- Error classification in pipeline is well-designed (retryable vs non-retryable)

### Bottom Line

**Public site: ship it.** It works.  
**Dashboard: not ready for a client who isn't you.** The silent pipeline, missing retry, and `alert()` errors will confuse any non-technical operator. Fix the 5 blockers above before handing dashboard access to a client.
